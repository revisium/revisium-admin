fragment Endpoint on EndpointModel {
  id
  type
  createdAt
  revisionId
  revision {
    id
    isDraft
    isHead
    createdAt
    branch {
      id
      name
    }
  }
}

fragment RevisionWithEndpoints on RevisionModel {
  id
  comment
  isDraft
  isHead
  isStart
  createdAt
  endpoints {
    id
    type
  }
}

fragment EndpointBranch on BranchModel {
  id
  name
  isRoot
  head {
    id
  }
  draft {
    id
  }
}

query getEndpointBranches($data: GetBranchesInput!) {
  branches(data: $data) {
    totalCount
    edges {
      node {
        ...EndpointBranch
      }
    }
  }
}

query getProjectEndpoints(
  $organizationId: String!
  $projectName: String!
  $first: Int!
  $after: String
  $branchId: String
  $type: EndpointType
) {
  projectEndpoints(
    data: {
      organizationId: $organizationId
      projectName: $projectName
      first: $first
      after: $after
      branchId: $branchId
      type: $type
    }
  ) {
    edges {
      node {
        ...Endpoint
      }
      cursor
    }
    pageInfo {
      hasNextPage
      hasPreviousPage
      startCursor
      endCursor
    }
    totalCount
  }
}

query getBranchRevisions($data: GetBranchInput!, $revisionsData: GetBranchRevisionsInput!) {
  branch(data: $data) {
    revisions(data: $revisionsData) {
      totalCount
      pageInfo {
        hasNextPage
        hasPreviousPage
        startCursor
        endCursor
      }
      edges {
        cursor
        node {
          ...RevisionWithEndpoints
        }
      }
    }
  }
}

mutation createEndpoint($data: CreateEndpointInput!) {
  createEndpoint(data: $data) {
    ...Endpoint
  }
}

mutation deleteEndpoint($data: DeleteEndpointInput!) {
  deleteEndpoint(data: $data)
}
